<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°é¸Ÿåœ°å›¾æ—…è¡Œè§„åˆ’</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ¦ å°é¸Ÿåœ°å›¾æ—…è¡Œè§„åˆ’ç³»ç»Ÿ</h1>
        <div class="section-divider">
            <span>ğŸŒ å°é¸Ÿåœ°å›¾æ—…è¡Œè·¯çº¿è§„åˆ’ç³»ç»Ÿ ğŸŒ</span>
        </div>
        <div class="instruction-box">
            <p>ğŸŒŸ è¾“å…¥ä½ æƒ³å»çš„åœ°æ–¹ï¼Œç³»ç»Ÿå°†å¸®ä½ è¿›è¡Œæœç´¢å’Œè§„åˆ’</p>
            <p>ğŸŒŸ æé—®ç¤ºä¾‹ï¼š</p>
            <ul>
                <li>å¤§ç†å¤åŸé™„è¿‘çš„æ™¯ç‚¹ï¼Œå¹¶ç»™æˆ‘æä¾›å…·ä½“çš„æ­¥è¡Œè·¯çº¿è§„åˆ’</li>
                <li>å¸®æˆ‘å¯¼èˆªä»æ˜†æ˜åˆ°å“ˆå°”æ»¨</li>
                <li>äº‘å—å¤§å­¦ä¸œé™†æ ¡åŒºé™„è¿‘çš„ä¸€äº›é…’åº—æ¨è</li>
            </ul>
        </div>

        <form id="queryForm">
            <div class="input-group">
                <label for="query" class="sr-only">ç›®çš„åœ°è¾“å…¥</label>
                <input type="text" id="query" name="query"
                       placeholder="è¯·è¾“å…¥ç›®çš„åœ°ï¼Œä¾‹å¦‚ï¼šåŒ—äº¬æ•…å®«é™„è¿‘çš„æ™¯ç‚¹è·¯çº¿è§„åˆ’" required>
                <button type="submit">å¼€å§‹è§„åˆ’</button>
            </div>
        </form>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div id="loading" class="loading">
            <div class="loader"></div>
            <p>æ­£åœ¨åŠªåŠ›è§„åˆ’è·¯çº¿ä¸­...</p>
        </div>

        <!-- ç»“æœå±•ç¤º -->
        <div id="resultContainer" class="result-container">
            <div id="resultContent"></div>
            <button onclick="resetForm()" class="back-btn">é‡æ–°è§„åˆ’</button>
        </div>
    </div>
<script>
document.getElementById('queryForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const query = document.getElementById('query').value;
    const resultDiv = document.getElementById('resultContent');
    const container = document.getElementById('resultContainer');
    const loading = document.getElementById('loading');

    loading.style.display = 'block';
    container.style.display = 'none';

    try {
        const response = await fetch('/process_query', {
            method: 'POST',
            headers: {'Content-Type': 'application/x-www-form-urlencoded'},
            body: `query=${encodeURIComponent(query)}`
        });

        const data = await response.json();
        loading.style.display = 'none';

        if (data.error) {
            resultDiv.innerHTML = `<div class="error">${data.error}</div>`;
        } else if (data.html_content) {
            // ç›´æ¥ä½¿ç”¨åç«¯æ ¼å¼åŒ–å¥½çš„HTML
            resultDiv.innerHTML = data.html_content;
        } else {
            resultDiv.innerHTML = "æœªæ‰¾åˆ°æœ‰æ•ˆç»“æœ";
        }

        container.style.display = 'block';
        window.scrollTo({
            top: container.offsetTop - 50,
            behavior: 'smooth'
        });

    } catch (err) {
        loading.style.display = 'none';
        resultDiv.innerHTML = `<div class="error">è¯·æ±‚å¤±è´¥ï¼š${err.message}</div>`;
        container.style.display = 'block';
    }
});
</script>
</body>
</html>
